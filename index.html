<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mais Lidas - Globo, Extra e G1</title>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 20px;
        }
        h1 {
            color: white; /* Título do header branco */
        }
        h2 {
            margin-top: 30px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f4f4f4;
        }
        button {
            padding: 5px 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        button:hover {
            background-color: #45a049;
        }
        a {
            color: #005a9c;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .table-links {
            color: #005a9c; /* Cor visível para os links nas tabelas */
            text-decoration: none;
        }
        .table-links:hover {
            text-decoration: underline;
        }
        .editoria-title {
            margin-top: 50px;
            padding: 10px;
            color: white;
        }
        .editoria-title-globo {
            background-color: #005a9c; /* Azul para Globo */
        }
        .editoria-title-extra {
            background-color: #e40100; /* Vermelho para Extra */
        }
        .editoria-title-g1 {
            background-color: #ff5a00; /* Laranja para G1 */
        }
        /* Header com âncoras */
        header {
            background-color: #005a9c;
            padding: 15px;
            text-align: center;
            color: white;
        }
        nav a {
            margin: 0 15px;
            color: white;
            text-decoration: none;
            font-size: 18px;
        }
        nav a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>

    <!-- Header com âncoras para Globo, Extra, G1 -->
    <header>
        <h1>Recirculação rápida das matérias mais lidas do Globo, Extra e G1</h1>
        <nav>
            <a href="#globo-section">Globo</a>
            <a href="#extra-section">Extra</a>
            <a href="#g1-section">G1</a>
        </nav>
    </header>

    <!-- Seção Globo -->
    <h2 id="globo-section">Globo</h2>
    <div id="globo-tables"></div>
    <div id="globo-error" class="error"></div>

    <!-- Seção Extra -->
    <h2 id="extra-section">Extra</h2>
    <div id="extra-tables"></div>
    <div id="extra-error" class="error"></div>

    <!-- Seção G1 -->
    <h2 id="g1-section">Mais Lidas - G1</h2>
    <div id="g1-tables"></div>
    <div id="g1-error" class="error"></div>

    <script>
        // Função para copiar o texto com hiperlink
        function copyAsLink(text, url, button) {
            const formattedLink = `${text} ${url.split('#')[0]}`;
            navigator.clipboard.writeText(formattedLink).then(() => {
                button.textContent = 'Copiado!';
                setTimeout(() => button.textContent = 'Copiar texto com link', 2000);
            });
        }

        // Função para copiar apenas o link
        function copyOnlyLink(url, button) {
            const cleanUrl = url.split('#')[0];
            navigator.clipboard.writeText(cleanUrl).then(() => {
                button.textContent = 'Link copiado!';
                setTimeout(() => button.textContent = 'Copiar apenas o link', 2000);
            });
        }

        // Função para buscar "Mais Lidas" do Globo
        async function fetchMaisLidasGlobo(url, containerId) {
            const proxyUrl = "https://api.allorigins.win/raw?url=";
            const container = document.getElementById(containerId);
            const errorDiv = document.getElementById('globo-error');

            try {
                const response = await fetch(`${proxyUrl}${encodeURIComponent(url)}`);
                const text = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(text, 'text/html');

                const maisLidas = doc.querySelectorAll('.card__highlight__title a');
                if (maisLidas.length === 0) {
                    errorDiv.textContent = `Nenhuma matéria "Mais Lida" encontrada no Globo.`;
                    return;
                }

                container.innerHTML = ''; // Limpa o container

                const categoryLinks = [];
                maisLidas.forEach(link => {
                    const href = link.href;
                    const textContent = link.textContent.trim();
                    if (textContent && href) {
                        categoryLinks.push({ href, textContent });
                    }
                });

                if (categoryLinks.length > 0) {
                    const table = document.createElement('table');
                    const thead = document.createElement('thead');
                    thead.innerHTML = `
                        <tr>
                            <th>Matéria</th>
                            <th>Ações</th>
                        </tr>
                    `;
                    table.appendChild(thead);

                    const tbody = document.createElement('tbody');
                    categoryLinks.slice(0, 5).forEach(link => {
                        const row = document.createElement('tr');

                        const descriptionCell = document.createElement('td');
                        descriptionCell.innerHTML = `<a href="${link.href}" target="_blank" class="table-links">${link.textContent}</a>`;

                        const copyButtonCell = document.createElement('td');

                        // Botão para copiar título + link
                        const copyButton = document.createElement('button');
                        copyButton.textContent = 'Copiar texto com link';
                        copyButton.onclick = () => copyAsLink(link.textContent, link.href, copyButton);

                        // Botão para copiar apenas o link
                        const copyLinkButton = document.createElement('button');
                        copyLinkButton.textContent = 'Copiar apenas o link';
                        copyLinkButton.onclick = () => copyOnlyLink(link.href, copyLinkButton);

                        copyButtonCell.appendChild(copyButton);
                        copyButtonCell.appendChild(copyLinkButton);

                        row.appendChild(descriptionCell);
                        row.appendChild(copyButtonCell);

                        tbody.appendChild(row);
                    });

                    table.appendChild(tbody);
                    container.appendChild(table);
                }

                if (categoryLinks.length === 0) {
                    container.innerHTML = 'Nenhuma matéria "Mais Lida" encontrada no Globo.';
                }
            } catch (error) {
                errorDiv.textContent = `Erro ao buscar as URLs: ${error.message}`;
                console.error(`Erro ao buscar as URLs do Globo:`, error);
            }
        }

        // Função para buscar "Mais Lidas" do Extra
        async function fetchMaisLidasExtra(url, containerId) {
            const proxyUrl = "https://api.allorigins.win/raw?url=";

            try {
                const response = await fetch(`${proxyUrl}${encodeURIComponent(url)}`);
                const text = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(text, 'text/html');

                const maisLidas = doc.querySelectorAll('.card__highlight__title a');
                const container = document.getElementById(containerId);
                container.innerHTML = ''; // Limpa o conteúdo anterior

                if (maisLidas.length > 0) {
                    const ul = document.createElement('ul');
                    maisLidas.forEach(link => {
                        const li = document.createElement('li');
                        li.innerHTML = `<a href="${link.href}" target="_blank">${link.textContent}</a>`;
                        ul.appendChild(li);
                    });
                    container.appendChild(ul);
                } else {
                    container.innerHTML = 'Nenhuma matéria "Mais Lida" encontrada no Extra.';
                }
            } catch (error) {
                console.error('Erro ao buscar as mais lidas do Extra:', error);
                container.innerHTML = 'Erro ao buscar as mais lidas do Extra.';
            }
        }

        // Função para buscar "Mais Lidas" do G1
        async function fetchMaisLidasG1() {
            const proxyUrl = "https://api.allorigins.win/raw?url=";
            const g1Url = "https://g1.globo.com/";
            const container = document.getElementById('g1-tables');
            const errorDiv = document.getElementById('g1-error');

            try {
                const response = await fetch(`${proxyUrl}${encodeURIComponent(g1Url)}`);
                const text = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(text, 'text/html');

                const maisLidas = doc.querySelectorAll('a[data-mrf-recirculation="Mais Lidas"]');

                if (maisLidas.length === 0) {
                    errorDiv.textContent = `Nenhuma matéria 'Mais Lida' encontrada no G1.`;
                    return;
                }

                container.innerHTML = ''; // Limpa o container

                const categoryLinks = [];
                maisLidas.forEach(link => {
                    const href = link.href;
                    const textContent = link.querySelector('.post-mais-lidas__title').textContent.trim();
                    if (textContent && href) {
                        categoryLinks.push({ href, textContent });
                    }
                });

                if (categoryLinks.length > 0) {
                    const table = document.createElement('table');
                    const thead = document.createElement('thead');
                    thead.innerHTML = `
                        <tr>
                            <th>Matéria</th>
                            <th>Ações</th>
                        </tr>
                    `;
                    table.appendChild(thead);

                    const tbody = document.createElement('tbody');
                    categoryLinks.slice(0, 5).forEach(link => {
                        const row = document.createElement('tr');

                        const descriptionCell = document.createElement('td');
                        descriptionCell.innerHTML = `<a href="${link.href}" target="_blank" class="table-links">${link.textContent}</a>`;

                        const copyButtonCell = document.createElement('td');

                        // Botão para copiar título + link
                        const copyButton = document.createElement('button');
                        copyButton.textContent = 'Copiar texto com link';
                        copyButton.onclick = () => copyAsLink(link.textContent, link.href, copyButton);

                        // Botão para copiar apenas o link
                        const copyLinkButton = document.createElement('button');
                        copyLinkButton.textContent = 'Copiar apenas o link';
                        copyLinkButton.onclick = () => copyOnlyLink(link.href, copyLinkButton);

                        copyButtonCell.appendChild(copyButton);
                        copyButtonCell.appendChild(copyLinkButton);

                        row.appendChild(descriptionCell);
                        row.appendChild(copyButtonCell);

                        tbody.appendChild(row);
                    });

                    table.appendChild(tbody);
                    container.appendChild(table);
                }

                if (categoryLinks.length === 0) {
                    container.innerHTML = 'Nenhuma matéria "Mais Lida" encontrada no G1.';
                }
            } catch (error) {
                errorDiv.textContent = `Erro ao buscar as URLs do G1: ${error.message}`;
                console.error(`Erro ao buscar as URLs do G1:`, error);
            }
        }

        // Função para buscar "Mais Lidas" de todas as editorias do Globo
        function fetchAllEditoriasGlobo() {
            const container = document.getElementById('globo-tables');
            container.innerHTML = ''; // Limpa o container antes de popular com os dados

            const editoriasGlobo = [
                { name: "Home", url: "https://oglobo.globo.com/" },
                { name: "Esportes", url: "https://oglobo.globo.com/esportes/" },
                { name: "Cultura", url: "https://oglobo.globo.com/cultura/" },
                { name: "Saúde", url: "https://oglobo.globo.com/saude/" },
                { name: "Economia", url: "https://oglobo.globo.com/economia/" },
                { name: "Mundo", url: "https://oglobo.globo.com/mundo/" },
                { name: "Rio", url: "https://oglobo.globo.com/rio/" },
                { name: "Brasil", url: "https://oglobo.globo.com/brasil/" },
                { name: "Política", url: "https://oglobo.globo.com/politica/" },
                { name: "Ela", url: "https://oglobo.globo.com/ela/" }
            ];

            editoriasGlobo.forEach(editoria => {
                const editoriaTitle = document.createElement('h2');
                editoriaTitle.innerHTML = `<a href="${editoria.url}" target="_blank">Mais Lidas - ${editoria.name}</a>`;
                editoriaTitle.classList.add('editoria-title', 'editoria-title-globo');
                container.appendChild(editoriaTitle);

                const editoriaContainer = document.createElement('div');
                editoriaContainer.id = `globo-editoria-${editoria.name.toLowerCase()}`;
                container.appendChild(editoriaContainer);

                fetchMaisLidasGlobo(editoria.url, editoriaContainer.id);
            });
        }

        // Função para buscar "Mais Lidas" de todas as editorias do Extra
        function fetchAllEditoriasExtra() {
            const container = document.getElementById('extra-tables');
            container.innerHTML = ''; // Limpa o container antes de popular com os dados

            const editoriasExtra = [
                { name: "Home", url: "https://extra.globo.com/" },
                { name: "Rio", url: "https://extra.globo.com/rio/" },
                { name: "Casos de Polícia", url: "https://extra.globo.com/rio/casos-de-policia/" },
                { name: "Famosos", url: "https://extra.globo.com/famosos/" },
                { name: "Entretenimento", url: "https://extra.globo.com/entretenimento/" },
                { name: "Economia", url: "https://extra.globo.com/economia/" },
                { name: "Esporte", url: "https://extra.globo.com/esporte/" }
            ];

            editoriasExtra.forEach(editoria => {
                const editoriaTitle = document.createElement('h2');
                editoriaTitle.innerHTML = `<a href="${editoria.url}" target="_blank">Mais Lidas - ${editoria.name}</a>`;
                editoriaTitle.classList.add('editoria-title', 'editoria-title-extra');
                container.appendChild(editoriaTitle);

                const editoriaContainer = document.createElement('div');
                editoriaContainer.id = `editoria-${editoria.name.toLowerCase()}`;
                container.appendChild(editoriaContainer);

                fetchMaisLidasExtra(editoria.url, editoriaContainer.id);
            });
        }

        // Funções de busca para Globo, Extra e G1
        fetchAllEditoriasGlobo();
        fetchAllEditoriasExtra();
        fetchMaisLidasG1();

        // Atualiza as listas a cada 5 minutos
        setInterval(function() {
            fetchAllEditoriasGlobo();
            fetchAllEditoriasExtra();
            fetchMaisLidasG1();
        }, 300000); // 5 minutos
    </script>

</body>
</html>
